【安全设计】
构建系统安全防护体系

安全维度：
1. 认证(Authentication)
   - 证明你是谁
   - 登录验证

2. 授权(Authorization)
   - 你能做什么
   - 权限控制

3. 数据安全
   - 传输加密
   - 存储加密
   - 数据脱敏

4. 接口安全
   - 防重放攻击
   - 限流防刷
   - 参数校验

认证方案：
• Session认证
  - 服务端存储会话
  - 适合传统Web

• Token认证(JWT)
  - 无状态
  - 适合分布式
  - 前后端分离

• OAuth 2.0
  - 第三方登录
  - 授权委托

授权模型：
• RBAC(基于角色)
  用户→角色→权限

• ABAC(基于属性)
  根据属性动态判断

权限设计：
```
用户(User)
  ↓ 拥有
角色(Role): admin, editor, viewer
  ↓ 包含
权限(Permission): user:create, post:delete
  ↓ 控制
资源(Resource): /api/users, /api/posts
```

常见攻击防护：
• XSS(跨站脚本)
  - 输入过滤
  - 输出转义
  - CSP策略

• CSRF(跨站请求伪造)
  - CSRF Token
  - SameSite Cookie
  - 验证Referer

• SQL注入
  - 参数化查询
  - ORM框架
  - 输入验证

• DDoS攻击
  - 限流
  - IP黑名单
  - CDN防护

加密策略：
→ HTTPS：传输加密
→ 密码Hash：bcrypt/argon2
→ 敏感数据：AES加密
→ API签名：HMAC-SHA256

安全检查清单：
□ 密码强度要求
□ 登录失败锁定
□ 敏感操作二次验证
□ 日志记录审计
□ 定期安全扫描

输出：
- 认证方案：[如何认证]
- 授权模型：[权限控制]
- 加密策略：[数据保护]
- 防护措施：[安全加固]
