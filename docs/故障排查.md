# 故障排查

当 VCP ToolBox 遇到问题时，可以按照以下步骤进行排查。

## 1. 查看控制台日志

VCP ToolBox 会在控制台（或 Docker 日志）中输出详细的运行信息和错误提示。这是排查问题的第一步。

- **直接运行**: 直接在启动 VCP ToolBox 的终端窗口查看。
- **PM2**: 使用 `pm2 logs VCPToolBox` 查看日志。
- **Docker**: 使用 `docker-compose logs -f` 查看日志。

关注日志中的 `[ERROR]` 或 `[WARN]` 级别的消息。

## 2. 检查 `config.env` 文件

很多问题都是由配置错误引起的。

- **格式错误**: 确保 `config.env` 文件是标准的 `key=value` 格式，不要有多余的空格或引号。
- **密钥错误**: 检查您的 `LLM_Key` 和其他插件的 API 密钥是否正确、有效，且没有被意外禁用。
- **URL 错误**: 检查 `LLM_URL` 和其他服务的 URL 是否可以正常访问。可以尝试在终端中使用 `curl` 命令测试连通性。

## 3. 插件相关问题

### 插件不工作

- **检查配置**: 确保该插件需要的配置项都已在 `config.env` 中正确填写。
- **检查启用状态**: 确认插件目录没有被重命名（例如添加了 `_` 前缀）。
- **查看插件日志**: 某些复杂的插件可能会有自己的日志文件，或者在主日志中输出带有插件名的信息。

### 插件加载失败

- **检查依赖**: 某些插件可能需要额外的系统依赖（例如 Python 环境、特定的库）。请查看插件目录下的 `requirements.txt` 或 `README.md` 文件。

## 4. 网络问题

- **端口占用**: 确保 `config.env` 中设置的 `Port` 没有被其他程序占用。
- **防火墙**: 检查服务器的防火墙规则，确保 VCP ToolBox 的端口和需要访问的外部服务端口是开放的。
- **网络连接**: 确保服务器可以正常访问互联网，特别是 `LLM_URL` 和其他 API 地址。

## 5. 前端连接问题

- **URL 和 Key 不匹配**: 检查您在前端填写的 VCP ToolBox 地址和 `Key` 是否与 `config.env` 中的 `Port` 和 `Key` 完全一致。
- **���络问题**: 确保您的电脑可以访问到 VCP ToolBox 服务器的地址和端口。

## 6. AI 行为异常

- **AI 不说话**:
    - 检查 `LLM_URL` 和 `LLM_Key` 是否配置正确。
    - 查看日志，确认是否成功向 LLM 发起了请求。
- **AI 不使用工具**:
    - 确认您的 LLM 是否支持工具调用 (Function Calling)。
    - 尝试在 Prompt 中更明确地引导 AI。
    - 检查插件是否正确加载和配置。

---

如果以上步骤都无法解决您的问题，建议前往项目的 [GitHub Issues](https://github.com/lioensky/VCPToolBox/issues) 页面寻求帮助。提问时，请尽量提供详细的错误日志、您的 `config.env` 文件（请隐去密钥信息）和复现问题的步骤。
