# 部署指南

本指南提供了在不同环境下部署 VCP ToolBox 的详细方法。

## 1. 基础部署 (使用 Node.js)

这是最基础的部署方式，适用于大多数个人用户和开发环境。

### 环境要求
- **Node.js**: v20.12.1 或更高
- **Git**

### 部署步骤
1.  **克隆项目**:
    ```bash
    git clone https://github.com/yuxuhai/VCPToolBox_test.git
    cd VCPToolBox_test
    ```
2.  **安装依赖**:
    ```bash
    npm install
    ```
3.  **配置 `config.env`**:
    - 复制 `config.env.example` 为 `config.env`。
    - 根据 **[配置说明](./配置说明.md)** 修改配置。
4.  **启动服务**:
    ```bash
    npm start
    ```

### 使用 PM2 进行进程管理

为了让 VCP 在后台持续运行，并能自动重启，推荐使用 [PM2](https://pm2.keymetrics.io/)。

1.  **安装 PM2**:
    ```bash
    npm install pm2 -g
    ```
2.  **使用 PM2 启动 VCP**:
    ```bash
    pm2 start server.js --name VCPToolBox
    ```
3.  **常用 PM2 命令**:
    - `pm2 list`: 查看所有进程状态
    - `pm2 stop VCPToolBox`: 停止 VCP
    - `pm2 restart VCPToolBox`: 重启 VCP
    - `pm2 logs VCPToolBox`: 查看 VCP 日志
    - `pm2 startup`: 设置开机自启

## 2. 使用 Docker 部署

Docker 可以提供一个隔离、一致的运行环境，简化部署流程。

### 环境要求
- **Docker**: 最新稳定版

### 部署步骤
1.  **克隆项目**:
    ```bash
    git clone https://github.com/yuxuhai/VCPToolBox_test.git
    cd VCPToolBox_test
    ```
2.  **配置 `config.env`**:
    - 复制 `config.env.example` 为 `config.env`。
    - 根据 **[配置说明](./配置说明.md)** 修改配置。**特别注意**：如果您的其他服务（如 AI 模型 API）也运行在 Docker 容器中，请确保网络设置正确，或者使用 `host.docker.internal` 来访问宿主机服务。
3.  **构建 Docker 镜像**:
    ```bash
    docker build -t vcp-toolbox .
    ```
4.  **运行 Docker 容器**:
    ```bash
    docker run -d -p 6005:6005 --name vcp-container -v $(pwd)/config.env:/app/config.env vcp-toolbox
    ```
    - `-d`: 后台运行
    - `-p 6005:6005`: 将容器的 6005 端口映射到宿主机的 6005 端口 (请根据您的 `PORT` 配置调整)
    - `--name vcp-container`: 给容器命名
    - `-v $(pwd)/config.env:/app/config.env`: 将宿主机的 `config.env` 文件挂载到容器中，方便修改配置

## 3. 使用 1Panel 部署

[1Panel](https://1panel.cn/) 是一个现代化的 Linux 服务器运维管��面板，可以方便地通过图形化界面部署和管理应用。

### 什么是 1Panel？
1Panel 是一个开源的服务器管理面板，它集成了应用商店、容器管理、文件管理、安全监控等多种功能，让您无需复杂的命令行操作即可管理服务器。

### 部署步骤
1.  **安装 1Panel**:
    请参考 [1Panel 官方文档](https://1panel.cn/docs/installation/online_installation/) 进行安装。

2.  **在 1Panel 中创建应用**:
    - 登录 1Panel，进入“应用商店”。
    - 选择“创建应用”。
    - **应用来源**: 选择“Git”。
    - **仓库地址**: 填入 `https://github.com/yuxuhai/VCPToolBox_test.git`。
    - **代码分支**: 默认为 `main`。
    - **运行环境**: 选择 `Node.js`，并确保版本为 v20 或更高。
    - **启动命令**: 填写 `npm start`。
    - **安装命令**: 填写 `npm install`。

3.  **配置应用**:
    - 在应用创建后，进入应用的“文件”管理。
    - 找到 `config.env.example`，复制为 `config.env`。
    - 在线编辑 `config.env` 文件，填入您的配置。
    - 在“端口”设置中，将容器端口和服务端口都设置为您在 `config.env` 中配置的 `PORT` (例如 `6005`)。

4.  **启动并访问**:
    - 启动应用。
    - 您可以通过 `http://<您的服务���IP>:<端口号>` 来访问 VCP 服务。

### 反向代理 (可选)

为了使用域名和 HTTPS 访问 VCP，您可以在 1Panel 中创建一个网站，并配置反向代理：

1.  **创建网站**:
    - 在 1Panel 中，进入“网站” -> “创建网站”。
    - 选择“反向代理”。
    - **主域名**: 填写您要使用的域名，例如 `vcp.yourdomain.com`。
    - **代理地址**: 填写 `http://127.0.0.1:<您的VCP端口号>`，例如 `http://127.0.0.1:6005`。
2.  **配置 SSL**:
    - 在网站设置中，申请并配置 SSL 证书，即可启用 HTTPS 访问。
3.  **更新 `config.env`**:
    - 将 `config.env` 中的 `VarHttpUrl` 或 `VarHttpsUrl` 更新为您的域名。

---

**下一步**

- 现在您已经成功部署了 VCP，是时候深入了解 **[插件使用指南](./插件使用指南.md)** 了。
