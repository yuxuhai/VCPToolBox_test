<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å·¥å…·åˆ—è¡¨é…ç½®ç¼–è¾‘å™¨</title>
    <link rel="stylesheet" href="tool_list_editor_new.css">
    <script>
        // ç›‘å¬æ¥è‡ªçˆ¶çª—å£çš„ä¸»é¢˜å˜åŒ–æ¶ˆæ¯
        window.addEventListener('message', (event) => {
            if (event.data && event.data.type === 'themeChange') {
                const theme = event.data.theme;
                document.documentElement.setAttribute('data-theme', theme);
            }
        });

        // é¡µé¢åŠ è½½æ—¶ï¼Œå‘çˆ¶çª—å£è¯·æ±‚å½“å‰ä¸»é¢˜
        window.addEventListener('DOMContentLoaded', () => {
            if (window.parent && window.parent !== window) {
                window.parent.postMessage({ type: 'requestTheme', for: 'tool_list_editor' }, '*');
            } else {
                // å¦‚æœæ˜¯ç‹¬ç«‹æ‰“å¼€ï¼Œåˆ™åº”ç”¨æœ¬åœ°å­˜å‚¨çš„ä¸»é¢˜æˆ–é»˜è®¤ä¸»é¢˜
                const storedTheme = localStorage.getItem('theme');
                const prefersDarkScheme = window.matchMedia("(prefers-color-scheme: dark)");
                if (storedTheme) {
                    document.documentElement.setAttribute('data-theme', storedTheme);
                } else {
                    document.documentElement.setAttribute('data-theme', prefersDarkScheme.matches ? 'dark' : 'light');
                }
            }
        });
    </script>
</head>
<body>
    <div class="container">
        <!-- é¡¶éƒ¨æ ‡é¢˜æ  -->
        <header class="page-header">
            <h1>ğŸ› ï¸ å·¥å…·åˆ—è¡¨é…ç½®ç¼–è¾‘å™¨</h1>
            <p class="description">å¿«é€Ÿåˆ¶ä½œå·¥å…·åˆ—è¡¨é…ç½®æ–‡ä»¶ï¼Œç”¨äºAgentçš„æç¤ºè¯ä¸­</p>
        </header>
        
        <!-- ä¸»è¦å†…å®¹åŒº - å·¦å³åˆ†æ å¸ƒå±€ -->
        <div class="main-content">
            <!-- å·¦ä¾§ï¼šå·¥å…·é€‰æ‹©åŒº -->
            <div class="left-panel">
                <!-- è¿‡æ»¤å’Œæœç´¢ -->
                <div class="filter-section">
                    <input type="search" id="tool-search" placeholder="ğŸ” æœç´¢å·¥å…·...">
                    <div class="filter-actions">
                        <label class="checkbox-label">
                            <input type="checkbox" id="show-selected-only">
                            <span>åªæ˜¾ç¤ºå·²é€‰</span>
                        </label>
                        <button id="select-all-btn" class="btn-secondary">å…¨é€‰</button>
                        <button id="deselect-all-btn" class="btn-secondary">æ¸…ç©º</button>
                    </div>
                    
                    <!-- æ’ä»¶æ˜¾ç¤ºè®¾ç½® -->
                    <div class="plugin-filter-section">
                        <button id="toggle-plugin-filter-btn" class="btn-plugin-filter">
                            <span class="icon">âš™ï¸</span>
                            <span class="text">æ’ä»¶æ˜¾ç¤ºè®¾ç½®</span>
                            <span class="arrow">â–¼</span>
                        </button>
                        <div id="plugin-filter-panel" class="plugin-filter-panel" style="display: none;">
                            <div class="plugin-filter-header">
                                <span>é€‰æ‹©è¦æ˜¾ç¤ºçš„æ’ä»¶ï¼š</span>
                                <div class="plugin-filter-actions">
                                    <button id="plugin-select-all-btn" class="btn-filter-action">å…¨é€‰</button>
                                    <button id="plugin-deselect-all-btn" class="btn-filter-action">æ¸…ç©º</button>
                                </div>
                            </div>
                            <div id="plugin-filter-list" class="plugin-filter-list">
                                <!-- æ’ä»¶å¤é€‰æ¡†å°†åŠ¨æ€åŠ è½½ -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- å·¥å…·åˆ—è¡¨ -->
                <div class="tools-container">
                    <h2>å¯ç”¨å·¥å…· <span id="tool-count">(åŠ è½½ä¸­...)</span></h2>
                    <div id="tools-list" class="tools-list">
                        <!-- å·¥å…·é¡¹å°†åŠ¨æ€åŠ è½½ -->
                    </div>
                </div>
            </div>

            <!-- å³ä¾§ï¼šé…ç½®å’Œé¢„è§ˆåŒº -->
            <div class="right-panel">
                <!-- é…ç½®æ–‡ä»¶ç®¡ç† -->
                <div class="config-manager">
                    <h2>ğŸ“ é…ç½®ç®¡ç†</h2>
                    <div class="config-selector">
                        <select id="config-file-select">
                            <option value="">-- æ–°å»ºé…ç½®æ–‡ä»¶ --</option>
                        </select>
                        <input type="text" id="new-config-name" placeholder="è¾“å…¥é…ç½®æ–‡ä»¶å..." style="display: none;">
                    </div>
                    
                    <div class="config-actions">
                        <button id="load-config-btn" class="btn-primary">åŠ è½½</button>
                        <button id="create-config-btn" class="btn-primary">æ–°å»º</button>
                        <button id="delete-config-btn" class="btn-danger" disabled>åˆ é™¤</button>
                        <button id="save-config-btn" class="btn-success" disabled>ğŸ’¾ ä¿å­˜</button>
                    </div>
                    
                    <span id="config-status" class="status-message"></span>
                </div>

                <!-- é¢„è§ˆåŒºåŸŸ -->
                <div class="preview-section">
                    <h2>ğŸ“ ç”Ÿæˆé¢„è§ˆ</h2>
                    <div class="preview-controls">
                        <label class="checkbox-label">
                            <input type="checkbox" id="include-header" checked>
                            <span>åŒ…å«æ–‡ä»¶å¤´</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="include-examples" checked>
                            <span>åŒ…å«ç¤ºä¾‹</span>
                        </label>
                        <button id="copy-preview-btn" class="btn-copy">ğŸ“‹ å¤åˆ¶</button>
                        <button id="export-txt-btn" class="btn-export" disabled>ğŸ“¤ å¯¼å‡ºTXT</button>
                    </div>
                    <textarea id="preview-output" readonly placeholder="é€‰æ‹©å·¥å…·åå°†åœ¨æ­¤æ˜¾ç¤ºé…ç½®å†…å®¹..."></textarea>
                </div>
            </div>
        </div>
    </div>

    <div id="loading-overlay" class="loading-overlay" style="display: none;">
        <div class="spinner"></div>
        <p>æ­£åœ¨åŠ è½½...</p>
    </div>

    <script src="tool_list_editor.js"></script>
</body>
</html>
